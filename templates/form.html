<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evaluación de Riesgo de Obesidad</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/estilos_formulario.css') }}">

</head>
<body>
    <div class="container">
        <header>
            <h1>Evaluación de Riesgo de Obesidad</h1>
            <p class="subtitle">Evalúe su riesgo de obesidad basado en hábitos y características personales</p>
        </header>

        <div class="tabs">
            <button class="tab active" onclick="openTab('form')">
                <i class="fas fa-clipboard-list"></i> Formulario
            </button>
            <button class="tab" onclick="openTab('analysis')">
                <i class="fas fa-chart-line"></i> Análisis de Factores
            </button>
            <button class="tab" onclick="openTab('relations')">
                <i class="fas fa-project-diagram"></i> Análisis de Relaciones
            </button>
        </div>

        <div id="form" class="tab-content active">
            <form action="/predict" method="post">
                <h2 class="section-title"><i class="fas fa-user"></i> Información Personal</h2>
                <div class="form-row">
                    <div class="form-col">
                        <div class="form-group">
                            <label for="Gender">Género:</label>
                            <select id="Gender" name="Gender" required>
                                <option value="" disabled selected>Seleccione una opción</option>
                                <option value="Male">Masculino</option>
                                <option value="Female">Femenino</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-col">
                        <div class="form-group">
                            <label for="Age">Edad:</label>
                            <input type="number" id="Age" name="Age" min="1" max="120" required placeholder="Años">
                        </div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-col">
                        <div class="form-group">
                            <label for="Height">Altura:</label>
                            <input type="number" step="0.01" id="Height" name="Height" min="0.5" max="2.5" required placeholder="Metros">
                        </div>
                    </div>
                    <div class="form-col">
                        <div class="form-group">
                            <label for="Weight">Peso:</label>
                            <input type="number" id="Weight" name="Weight" min="20" max="300" required placeholder="Kilogramos">
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="family_history">
                        Historial familiar de obesidad:
                        <span class="tooltip">
                            <span class="info-icon">i</span>
                            <span class="tooltip-text">Indique si tiene familiasres directos (padres, hermanos) con obesidad.</span>
                        </span>
                    </label>
                    <select id="family_history" name="family_history" required>
                        <option value="" disabled selected>Seleccione una opción</option>
                        <option value="yes">Sí</option>
                        <option value="no">No</option>
                    </select>
                </div>

                <h2 class="section-title"><i class="fas fa-utensils"></i> Hábitos Alimenticios</h2>
                <div class="form-group">
                    <label for="FAVC">
                        ¿Consume alimentos altos en calorías frecuentemente?
                        <span class="tooltip">
                            <span class="info-icon">i</span>
                            <span class="tooltip-text">Comida rápida, dulces, alimentos fritos, etc.</span>
                        </span>
                    </label>
                    <select id="FAVC" name="FAVC" required>
                        <option value="" disabled selected>Seleccione una opción</option>
                        <option value="yes">Sí</option>
                        <option value="no">No</option>
                    </select>
                </div>

                <div class="form-row">
                    <div class="form-col">
                        <div class="form-group">
                            <label for="FCVC">
                                Frecuencia de consumo de vegetales:
                                <span class="tooltip">
                                    <span class="info-icon">i</span>
                                    <span class="tooltip-text">Escala del 1 al 3 (1: nunca, 2: a veces, 3: siempre)</span>
                                </span>
                            </label>
                            <select id="FCVC" name="FCVC" required>
                                <option value="" disabled selected>Seleccione una opción</option>
                                <option value="1">1 - Nunca/Raramente</option>
                                <option value="2">2 - A veces</option>
                                <option value="3">3 - Siempre/Frecuentemente</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-col">
                        <div class="form-group">
                            <label for="NCP">Número de comidas principales al día:</label>
                            <select id="NCP" name="NCP" required>
                                <option value="" disabled selected>Seleccione una opción</option>
                                <option value="1">1 comida</option>
                                <option value="2">2 comidas</option>
                                <option value="3">3 comidas</option>
                                <option value="4">4 o más comidas</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="CAEC">Consumo de alimentos entre comidas:</label>
                    <select id="CAEC" name="CAEC" required>
                        <option value="" disabled selected>Seleccione una opción</option>
                        <option value="no">No</option>
                        <option value="Sometimes">A veces</option>
                        <option value="Frequently">Frecuentemente</option>
                        <option value="Always">Siempre</option>
                    </select>
                </div>

                <div class="form-row">
                    <div class="form-col">
                        <div class="form-group">
                            <label for="SMOKE">¿Fuma?</label>
                            <select id="SMOKE" name="SMOKE" required>
                                <option value="" disabled selected>Seleccione una opción</option>
                                <option value="yes">Sí</option>
                                <option value="no">No</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-col">
                        <div class="form-group">
                            <label for="CH2O">Consumo de agua diario:</label>
                            <input type="number" step="0.1" id="CH2O" name="CH2O" min="0" max="10" required placeholder="Litros">
                        </div>
                    </div>
                </div>

                <h2 class="section-title"><i class="fas fa-running"></i> Estilo de Vida</h2>
                <div class="form-group">
                    <label for="SCC">
                        ¿Se considera sedentario?
                        <span class="tooltip">
                            <span class="info-icon">i</span>
                            <span class="tooltip-text">Poca actividad física diaria y mucho tiempo sentado.</span>
                        </span>
                    </label>
                    <select id="SCC" name="SCC" required>
                        <option value="" disabled selected>Seleccione una opción</option>
                        <option value="yes">Sí</option>
                        <option value="no">No</option>
                    </select>
                </div>

                <div class="form-row">
                    <div class="form-col">
                        <div class="form-group">
                            <label for="FAF">Frecuencia de actividad física semanal:</label>
                            <select id="FAF" name="FAF" required>
                                <option value="" disabled selected>Seleccione una opción</option>
                                <option value="0">0 - Ninguna</option>
                                <option value="1">1 - 1 vez por semana</option>
                                <option value="2">2 - 2 veces por semana</option>
                                <option value="3">3 - 3 veces por semana</option>
                                <option value="4">4 o más veces por semana</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-col">
                        <div class="form-group">
                            <label for="TUE">Horas de uso de tecnología al día:</label>
                            <input type="number" id="TUE" name="TUE" min="0" max="24" required placeholder="Horas">
                        </div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-col">
                        <div class="form-group">
                            <label for="CALC"> ¿Con qué frecuencia bebe alcohol?</label>
                            <select id="CALC" name="CALC" required>
                                <option value="" disabled selected>Seleccione una opción</option>
                                <option value="No">No</option>
                                <option value="Rarely">Raramente</option>
                                <option value="Sometimes">A veces</option>
                                <option value="Frequently">Frecuentemente</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-col">
                        <div class="form-group">
                            <label for="MTRANS">Modo de transporte habitual:</label>
                            <select id="MTRANS" name="MTRANS" required>
                                <option value="" disabled selected>Seleccione una opción</option>
                                <option value="Walking">Caminando</option>
                                <option value="Bike">Bicicleta</option>
                                <option value="Public_Transportation">Transporte público</option>
                                <option value="Automobile">Automóvil</option>
                                <option value="Other">Otro</option>
                            </select>
                        </div>
                    </div>
                </div>

                <button type="submit" class="btn-submit">Evaluar Riesgo</button>
            </form>
        </div>

        <div id="analysis" class="tab-content">
            <h2 class="section-title"><i class="fas fa-chart-bar"></i> Análisis de Factores de Riesgo</h2>

            <div class="cards-container">
                <div class="info-card">
                    <h3>Factor Más Influyente</h3>
                    <p>Factores dietéticos inadecuados, como una alimentación alta en calorías y baja en nutrientes, pueden aumentar el riesgo de obesidad en un <strong>38%</strong>.</p>

                </div>
                <div class="info-card">
                    <h3>Factor Más Controlable</h3>
                    <p>Incrementar el consumo de vegetales de manera regular puede reducir el riesgo de obesidad en un <strong>20%</strong>.</p>
                </div>
                <div class="info-card">
                    <h3>Combinación Óptima</h3>
                    <p>3+ días de ejercicio y consumo diario de agua <strong>2L+</strong></p>
                </div>
            </div>

            <div class="chart-container">
                <h3>Impacto de Factores Controlables</h3>
                <canvas id="factorImpactChart"></canvas>
            </div>

            <div class="chart-container">
                <h3>Distribución de Riesgo por Factores</h3>
                <canvas id="riskDistributionChart"></canvas>
            </div>
        </div>
    </div>
    <div id="relations" class="tab-content">
        <h2 class="section-title"><i class="fas fa-project-diagram"></i> Grafo de Relaciones entre Variables</h2>
             <!-- Nuevas tarjetas de correlaciones -->
        <div class="cards-container">
            <div class="info-card">
                <h3>Correlaciones Más Fuertes</h3>
                <p>Las relaciones con mayor impacto en el estudio son:</p>
                <ul>
                    <li><strong>IMC → Nivel de Obesidad</strong>: Relación Chi² con intensidad de 0.97, siendo el principal determinante del nivel de obesidad.</li>
                    <li><strong>Peso → IMC</strong>: Correlación positiva con intensidad de 0.93, mostrando cómo el peso influye directamente en el IMC.</li>
                    <li><strong>Nivel de Obesidad → Peso</strong>: Relación ANOVA con intensidad de 0.85, evidenciando la relación bidireccional entre estas variables.</li>
                </ul>
            </div>

            <div class="cards-container">
                <div class="info-card">
                    <h3>Relaciones Claves en el Estilo de Vida</h3>
                    <p>Algunos hábitos tienen correlaciones significativas que pueden impactar la salud:</p>
                    <ul>
                        <li><strong>Consumo de Agua → Frecuencia de Actividad Física</strong>: Correlación positiva (0.16, Pearson). Indica que quienes realizan más actividad física tienden a consumir más agua, lo que resalta la importancia de la hidratación en la rutina deportiva.</li>
                        <li><strong>Frecuencia de Consumo de Verduras → Número de Comidas Principales</strong>: Correlación positiva (0.04, Pearson). Sugiere que las personas que consumen más verduras suelen tener una mayor estructura en sus comidas diarias.</li>
                        <li><strong>Fumar → Consumo de Alcohol</strong>: Relación Chi² con intensidad de 0.11. Muestra que quienes fuman tienen una mayor probabilidad de consumir alcohol con más frecuencia.</li>
                    </ul>
                </div>
            </div>

            <div class="info-card">
                <h3>Variables Determinantes por Género</h3>
                <p>El género muestra influencias importantes:</p>
                <ul>
                    <li><strong>Nivel de Obesidad → Género</strong>: Relación Chi² con intensidad de 0.56, mostrando diferencias significativas en obesidad por género.</li>
                    <li><strong>Género → Altura</strong>: Relación ANOVA que confirma diferencias antropométricas naturales.</li>
                    <li>El género parece influir en varios factores de estilo de vida que indirectamente afectan el nivel de obesidad.</li>
                </ul>
            </div>
        </div>
        <div class="info-card">
            <h3>Interpretación del Grafo</h3>
            <p>Este grafo muestra las relaciones estadísticamente significativas entre diferentes variables. Las líneas indican el tipo de relación:</p>
            <ul>
                <li><span style="color: #4CAF50;">Verde</span>: Correlación positiva: una variable aumenta, cuando la otra aumenta.</li>
                <li><span style="color: #F44336;">Rojo</span>: Correlación negativa: una variable aumenta, cuando la otra disminuye.</li>
                <li><span style="color: #FF9800;">Naranja</span>: Relación ANOVA: Se usa para comparar si una variable categórica afecta a una variable numérica.</li>
                <li><span style="color: #9C27B0;">Morado</span>: Relación Chi²: Se usa para ver si dos variables categóricas están relacionadas.</li>
            </ul>
            <p>Los nodos azules representan variables numéricas, mientras que los verdes son variables categóricas.</p>
        </div>

        <div class="chart-container">
            <div id="grafoRelaciones" style="width:100%; height:600px;"></div>
        </div>
    </div>

    </div>

    <script>
        // Función para cambiar entre pestañas
        function openTab(tabName) {
            const tabContents = document.getElementsByClassName('tab-content');
            for (let i = 0; i < tabContents.length; i++) {
                tabContents[i].classList.remove('active');
            }

            const tabs = document.getElementsByClassName('tab');
            for (let i = 0; i < tabs.length; i++) {
                tabs[i].classList.remove('active');
            }

            document.getElementById(tabName).classList.add('active');
            event.currentTarget.classList.add('active');
        }

    </script>
<script src="{{ url_for('static', filename='js/script_formulario.js') }}"></script>

</body>
</html>